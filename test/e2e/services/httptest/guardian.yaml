apiVersion: guard.security.knative.dev/v1alpha1
kind: Guardian
metadata:
  name: testsrv
spec:
  control:
    alert: true
    auto: true
    block: true
    force: false
    learn: false
  learned:
    active: true
    envelop:
      completiontime: 3
      responsetime: 3
    pod:
      tcp4peers: null
      tcp6peers: null
      udp4peers: null
      udp6peers: null
      udplite4peers: null
      udplite6peers: null
    req:
      cip: null
      contentlength:
      - max: 0
        min: 0
      headers:
        kv:
          otherKeynames: null
          otherVals: null
          vals:
            Accept:
              digits: 0
              flags: 1073750272
              letters: 0
              nonreadables: 0
              schars: 3
              sequences: 1
              spaces: 0
              unicodeFlags: null
              unicodes: 0
            Forwarded:
              digits: 8
              flags: 167936
              letters: 12
              nonreadables: 0
              schars: 6
              sequences: 13
              spaces: 0
              unicodeFlags: null
              unicodes: 0
            K-Proxy-Request:
              digits: 0
              flags: 0
              letters: 9
              nonreadables: 0
              schars: 0
              sequences: 1
              spaces: 0
              unicodeFlags: null
              unicodes: 0
            User-Agent:
              digits: 4
              flags: 12288
              letters: 4
              nonreadables: 0
              schars: 3
              sequences: 7
              spaces: 0
              unicodeFlags: null
              unicodes: 0
            X-Forwarded-For:
              digits: 15
              flags: 5120
              letters: 0
              nonreadables: 0
              schars: 7
              sequences: 16
              spaces: 1
              unicodeFlags: null
              unicodes: 0
            X-Forwarded-Proto:
              digits: 0
              flags: 0
              letters: 4
              nonreadables: 0
              schars: 0
              sequences: 1
              spaces: 0
              unicodeFlags: null
              unicodes: 0
            X-Request-Id:
              digits: 24
              flags: 2048
              letters: 20
              nonreadables: 0
              schars: 4
              sequences: 24
              spaces: 0
              unicodeFlags: null
              unicodes: 0
      hopip: null
      mediatype:
        params:
          otherKeynames: null
          otherVals: null
          vals: null
        type:
          set:
          - none
      method:
        set:
        - GET
      proto:
        set:
        - HTTP/1.1
      qs:
        kv:
          otherKeynames: null
          otherVals: null
          vals: null
      url:
        segments:
        - max: 1
          min: 0
        val:
          digits: 0
          flags: 0
          letters: 3
          nonreadables: 0
          schars: 0
          sequences: 1
          spaces: 0
          unicodeFlags: null
          unicodes: 0
    reqbody:
      faults:
        set: []
      structured: null
      unstructured: null
    resp:
      contentlength:
      - max: 8
        min: 8
      headers:
        kv:
          otherKeynames: null
          otherVals: null
          vals:
            Content-Length:
              digits: 3
              flags: 0
              letters: 0
              nonreadables: 0
              schars: 0
              sequences: 1
              spaces: 0
              unicodeFlags: null
              unicodes: 0
            Content-Type:
              digits: 1
              flags: 174080
              letters: 17
              nonreadables: 0
              schars: 4
              sequences: 10
              spaces: 1
              unicodeFlags: null
              unicodes: 0
            Date:
              digits: 12
              flags: 17408
              letters: 9
              nonreadables: 0
              schars: 3
              sequences: 16
              spaces: 5
              unicodeFlags: null
              unicodes: 0
      mediatype:
        params:
          otherKeynames: null
          otherVals: null
          vals:
            charset:
              digits: 1
              flags: 2048
              letters: 3
              nonreadables: 0
              schars: 1
              sequences: 3
              spaces: 0
              unicodeFlags: null
              unicodes: 0
        type:
          set:
          - text/html
    respbody:
      faults:
        set: []
      structured: null
      unstructured:
        digits: 8
        flags: 95233
        letters: 47
        nonreadables: 5
        schars: 23
        sequences: 40
        spaces: 16
        unicodeFlags: []
        unicodes: 0
  samples: 1013
